

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8.0 UWC Modbus Operations &mdash;   documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9.0 Sparkplug-Bridge Operations" href="page_09.html" />
    <link rel="prev" title="7.0 Site Configurations" href="page_07.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> 
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="First_pg.html">Legal Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_01.html">1.0  Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_01.html#purpose">1.1  Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_01.html#scope">1.2  Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_01.html#system-requirements">1.3  System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_02.html">2.0 Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#feature-list-supported-in-uwc-v1-6">2.1 Feature list- supported in UWC-v1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#feature-list-supported-in-uwc-v1-5">2.2 Feature list- supported in UWC-v1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#feature-list-supported-in-uwc-v1-0">2.3 Feature list supported in UWC-v1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#changes-to-existing-features">2.4 Changes to Existing Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#unsupported-or-discontinued-features">2.5 Unsupported or Discontinued Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_03.html">3.0  Before Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_03.html#uwc-for-o-g-site">3.1  UWC for O&amp;G Site</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_03.html#upstream-oil-and-gas-facilities">3.2  Upstream Oil and Gas Facilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_03.html#understanding-uwc-platform">3.3  Understanding UWC Platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_03.html#modbus-containers">3.3.1  Modbus containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_03.html#mqtt-bridge-container">3.3.2   MQTT-Bridge container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_03.html#sparkplug-bridge-container">3.3.3  Sparkplug-Bridge container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_03.html#kpi-application-container">3.3.4  KPI Application Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_03.html#configurations">3.3.5  Configurations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_04.html">4.0  Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_04.html#how-to-install-uwc-software-with-eii-installer">4.1  How to install UWC software with EII installer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_05.html">5.0  Container Configuration setting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_05.html#deactivate-auto-update">5.1     Deactivate Auto Update</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_05.html#deactivate-unattended-upgrades">5.1.1   Deactivate Unattended Upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_05.html#deactivate-periodic-unattended-upgrades">5.1.2   Deactivate Periodic Unattended Upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_05.html#deactivate-scheduled-upgrades">5.1.3   Deactivate Scheduled Upgrades</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_06.html">6.0  Container Configuration setting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#containers">6.1  Containers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#common-configuration-for-modbus-client-containers">6.1.1  Common Configuration for Modbus Client Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#configuration-foodbus-network">6.1.2  Configuration foodbus network</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#modbus-tcp-communication">6.2             Modbus TCP Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#modbus-rtu-communication">6.3         Modbus RTU Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#mqtt-bridge">6.4     MQTT Bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#mqtt">6.5     MQTT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#accessing-secured-mqtt-container-from-an-external-mqtt-client">6.5.1   Accessing secured MQTT container from an external MQTT client</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#accessing-secured-mqtt-container-from-a-client-inside-a-container">6.5.2   Accessing secured MQTT container from a client inside a container</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#sparkplug-bridge">6.6     Sparkplug-Bridge</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#pre-requisite-for-running-sparkplug-bridge">6.6.1   Pre-requisite for running Sparkplug-Bridge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#kpi-app">6.7     KPI App</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_07.html">7.0  Site Configurations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#system-level-global-configuration">7.1     System Level Global Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_07.html#settings-for-polling-and-on-demand-operation">7.1.1   Settings for Polling and On-Demand operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_07.html#settings-for-sparkplug-bridge-sparkplug-communication-operation">7.1.2   Settings for Sparkplug-Bridge – SparkPlug communication operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_07.html#settings-for-default-scale-factor">7.1.3   Settings for default scale factor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#how-to-configure-site-and-wellhead">7.2     How to Configure Site and Wellhead</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_07.html#configuring-tcp-device-in-device-group">7.2.1   Configuring TCP device in device-group</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_07.html#configuring-rtu-device-in-device-group">7.2.2   Configuring RTU device in device-group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#how-to-configure-devices">7.3     How to Configure Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#how-to-configure-device-points">7.4     How to Configure Device points</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#how-to-add-edit-delete-new-wellhead-device-point-configurations">7.5     How to add/edit/delete new wellhead/device/point configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#kpi-app-configuration">7.6     KPI App Configuration</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8.0     UWC Modbus Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-polling">8.1     Data Polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#on-demand-write">8.2     On-Demand Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="#on-demand-read">8.3     On-Demand Read</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kpi-application">8.4     KPI Application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_09.html">9.0     Sparkplug-Bridge Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_09.html#app-virtual-device-communication">9.1     App (virtual device) communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#app-message-topic-format">9.1.1   App Message Topic Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#app-message-birth">9.1.2   App Message - BIRTH</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#app-message-data">9.1.3   App Message - DATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#app-message-cmd">9.1.4   App Message - CMD</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#app-message-death">9.1.5   App Message - DEATH</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#app-message-templatedef">9.1.6   App Message - TemplateDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#start-birth-process">9.1.7   START_BIRTH_PROCESS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_09.html#modbus-real-device-communication">9.2     Modbus (real) device communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#support-for-dbirth">9.2.1   Support for DBIRTH</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#support-for-ddata">9.2.2   Support for DDATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#support-for-dcmd">9.2.3   Support for DCMD</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#support-for-ddeath">9.2.4   Support for DDEATH</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_09.html#sparkplug-messages">9.3     SparkPlug Messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#nbirth-message">9.3.1   NBIRTH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#ndeath-message">9.3.2   NDEATH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#dbirth-message">9.3.3   DBIRTH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#ddeath-message">9.3.4   DDEATH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#ddata-message">9.3.5   DDATA Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_09.html#ncmd-message">9.3.6   NCMD Message</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_10.html">10.0    Debugging steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_11.html">11.0    Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_12.html">12.0    Steps to flash LFM BIOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_13.html">13.0    UWC Gateway to Cloud Communication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#architecture">13.1    Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#installation-and-configuration">13.2    Installation and Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_13.html#ssb-installation-and-cloud-infrastructure-provisioning">13.2.1  SSB installation and cloud infrastructure provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_13.html#aws-iot-core-broker-and-ssb-configuration">13.2.2  AWS IoT core broker and SSB configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_13.html#uwc-gateway-configuration">13.2.3  UWC gateway configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#monitor-data-on-cloud">13.3    Monitor Data on Cloud</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_14.html">14.0 RT Patch (Optional)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_14.html#steps-to-choose-and-apply-rt-kernel-patch">14.1    Steps to Choose and Apply RT Kernel Patch</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_14.html#steps-to-apply-rt-kernel-patch">14.2    Steps To Apply RT Kernel Patch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_15.html">15.0 Appendix</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html"></a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>8.0     UWC Modbus Operations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com//open-edge-insights/uwc-docs/blob/develop/source/Pages/page_08.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="uwc-modbus-operations">
<h1>8.0     UWC Modbus Operations<a class="headerlink" href="#uwc-modbus-operations" title="Permalink to this headline">¶</a></h1>
<p>This section provides configurations required to read and write data from sensors and actuators connected over Modbus TCP or RTU on UWC gateway.
An application can perform following operations using UWC containers:</p>
<blockquote>
<div><ul class="simple">
<li><p>Data Polling</p></li>
<li><p>On-Demand Write</p></li>
<li><p>On-Demand Read</p></li>
</ul>
</div></blockquote>
<p>Following section explains how to use MQTT topics to perform above operations. Further these operations can be performed in realtime (RT) and non-realtime (Non-RT) mode.
Multiple modules are involved in processing the operation. To capture the time taken by each module (i.e., a step), epoch timestamps in microseconds are added at various levels. These timestamps are present in JSON message.</p>
<p><strong>The table of terms here is useful for interpreting the JSON payloads of the messages.</strong></p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/table10_1_updated.png"><img alt="../_images/table10_1_updated.png" src="../_images/table10_1_updated.png" style="width: 459.9px; height: 573.3px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/table10_2_update.png"><img alt="../_images/table10_2_update.png" src="../_images/table10_2_update.png" style="width: 461.29999999999995px; height: 577.5px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/table10_3_update.png"><img alt="../_images/table10_3_update.png" src="../_images/table10_3_update.png" style="width: 461.99999999999994px; height: 578.9px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/table10_4_update.png"><img alt="../_images/table10_4_update.png" src="../_images/table10_4_update.png" style="width: 459.9px; height: 201.6px;" /></a>
</div>
<div class="section" id="data-polling">
<h2>8.1     Data Polling<a class="headerlink" href="#data-polling" title="Permalink to this headline">¶</a></h2>
<p>In the datapoint YML configuration file, a polling frequency is configured. As per polling frequency, data is fetched from the end point and published on MQTT by the UWC container. This section describes how to read the data for polled points using MQTT.</p>
<p>The data actions which are “Polling” actions are initiated by the Protocol container (in this case the Modbus protocol application (i.e., the driver) within the Modbus container.</p>
<p>To receive polled data: Application should use a topic in following format to receive (i.e., subscribe) polling data from MQTT:</p>
<dl class="simple">
<dt><strong>MQTT topic to receive (i.e., subscribe) write response:</strong></dt><dd><p><strong>/device/wellhead/point/update</strong></p>
</dd>
</dl>
<p>Please refer to the table in section 6 for details of fields.</p>
<p><strong>Example:</strong></p>
<p><strong>Polling Topic</strong>: /flowmeter/PL0/D3/update</p>
<p><strong>Polling Message</strong>: Success Response</p>
<p>{</p>
<blockquote>
<div><p>“datatype”: “int16”,</p>
<p>“respPostedByStack”: “1626778386833063”,</p>
<p>“dataPersist”: true,</p>
<p>“respRcvdByStack”: “1626778386832788”,</p>
<p>“status”: “Good”,</p>
<p>“tsMsgRcvdForProcessing”: “1626778386838199”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“scaledValue”: 4,</p>
<p>“driver_seq”: “1153204606361944465”,</p>
<p>“value”: “0x0004”,</p>
<p>“reqRcvdInStack”: “1626778386809284”,</p>
<p>“data_topic”: “/flowmeter/PL0/D3/update”,</p>
<p>“metric”: “D3”,</p>
<p>“usec”: “1626778386833431”,</p>
<p>“reqSentByStack”: “1626778386819158”,</p>
<p>“tsPollingTime”: “1626778386809058”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“timestamp”: “2021-07-20 10:53:06”,</p>
<p>“tsMsgReadyForPublish”: “1626778386838268”</p>
</div></blockquote>
<p>}</p>
<p><strong>Polling Message</strong>: Error Response</p>
<p>{</p>
<blockquote>
<div><p>“datatype”: “int16”,</p>
<p>“respPostedByStack”: “0”,</p>
<p>“lastGoodUsec”: “1626847050409405”,</p>
<p>“realtime”: “0”,</p>
<p>“dataPersist”: true,</p>
<p>“respRcvdByStack”: “0”,</p>
<p>“status”: “Bad”,</p>
<p>“tsMsgRcvdForProcessing”: “1626847098399696”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“scaledValue”: 0,</p>
<p>“driver_seq”: “1155737881221051931”,</p>
<p>“value”: “0x00”,</p>
<p>“reqRcvdInStack”: “0”,</p>
<p>“data_topic”: “/flowmeter/PL0/D3/update”,</p>
<p>“metric”: “D3”,</p>
<p>“usec”: “1626847098395437”,</p>
<p>“reqSentByStack”: “0”,</p>
<p>“tsPollingTime”: “1626847098394978”,</p>
<p>“version”: “2.0”,</p>
<p>“error_code”: “2003”,</p>
<p>“timestamp”: “2021-07-21 05:58:18”,</p>
<p>“tsMsgReadyForPublish”: “1626847098399751”</p>
</div></blockquote>
<p>}</p>
</div>
<div class="section" id="on-demand-write">
<h2>8.2     On-Demand Write<a class="headerlink" href="#on-demand-write" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to write data to some specific Modbus point using MQTT.</p>
<p>To send request: Application should use a topic in the following format to send (i.e., publish) write request on MQTT:</p>
<p><strong>MQTT topic to send (i.e., publish) write request: /device/wellhead/point/write</strong></p>
<p>To receive response: Application should use a topic in the following format to receive (i.e., subscribe) response of write request from MQTT:</p>
<p><strong>MQTT topic to receive (i.e., subscribe) write response: /device/wellhead/point/writeResponse</strong></p>
<p>Please refer to the table in section 6 for details of fields.</p>
<p><strong>Example:</strong></p>
<p><strong>Request Topic</strong>: /flowmeter/PL0/Flow/write</p>
<p><strong>Request Message:</strong></p>
<p>{“wellhead”:”PL0”,”command”:”Flow”,”value”:”0x00”,”timestamp”:”2019-09-20 12:34:56”,”usec”:”1571887474111145”,”version”:”2.0”,”app_seq”:”1234”}</p>
<p>A message without <em>“realtime”</em> field is treated as a non-realtime message. To execute a message in realtime way, a field called <em>“realtime”</em> should be added as shown below:</p>
<p>{“wellhead”:”PL0”,”command”:”Flow”,”value”:”0x00”,”timestamp”:”2019-09-20 12:34:56”,”usec”:”1571887474111145”,”version”:”2.0”,”app_seq”:”1234”,”realtime”:”1”}</p>
<p>A message with <em>“value”</em> is treated as On-Demand Write from vendor App.</p>
<p>{“wellhead” : “PL0”,”command” : “INT16_MF10”,”timestamp” : “2019-09-20 12:34:56”,
“usec” : “1571887474111145”,”version” : “2.0”,”realtime” : “0”,”app_seq” : “1234”,
“scaledValue” : 12}</p>
<p>A message with <em>“scaledValue”</em> is treated as On-Demand Write from Ignition system.</p>
<p>The <em>“value”</em> / <em>“scaledValue”</em> field represents value to be written to the end device as a part of on-demand write operation.</p>
<p><strong>Response Topic:</strong> /flowmeter/PL0/Flow/writeResponse</p>
<p><strong>Response Message:</strong> Success Response</p>
<p>{</p>
<blockquote>
<div><p>“app_seq”: “1234”,</p>
<p>“respPostedByStack”: “1626846891692261”,</p>
<p>“dataPersist”: true,</p>
<p>“respRcvdByStack”: “1626846891692219”,</p>
<p>“status”: “Good”,</p>
<p>“tsMsgRcvdForProcessing”: “1626846891693976”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“tsMsgRcvdFromMQTT”: “1626846891669463”,</p>
<p>“tsMsgPublishOnEII”: “1626846891669925”,</p>
<p>“reqRcvdInStack”: “1626846891672050”,</p>
<p>“data_topic”: “/flowmeter/PL0/Flow/writeResponse”,</p>
<p>“reqRcvdByApp”: “1626846891671963”,</p>
<p>“metric”: “Flow”,</p>
<p>“usec”: “1626846891692549”,</p>
<p>“reqSentByStack”: “1626846891673238”,</p>
<p>“timestamp”: “2021-07-21 05:54:51”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“tsMsgReadyForPublish”: “1626846891694023”</p>
</div></blockquote>
<p>}</p>
<p><strong>Response Message</strong>: Error Response</p>
<p>{</p>
<blockquote>
<div><p>“app_seq”: “1234”,</p>
<p>“respPostedByStack”: “0”,</p>
<p>“dataPersist”: true,</p>
<p>“respRcvdByStack”: “0”,</p>
<p>“status”: “Bad”,</p>
<p>“tsMsgRcvdForProcessing”: “1626778808002974”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“tsMsgRcvdFromMQTT”: “1626778808000285”,</p>
<p>“tsMsgPublishOnEII”: “1626778808000437”,</p>
<p>“reqRcvdInStack”: “0”,</p>
<p>“data_topic”: “/flowmeter/PL0/Flow/writeResponse”,</p>
<p>“reqRcvdByApp”: “1626778808001309”,</p>
<p>“metric”: “Flow”,</p>
<p>“usec”: “1626778808001814”,</p>
<p>“reqSentByStack”: “0”,</p>
<p>“error_code”: “2003”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“timestamp”: “2021-07-20 11:00:08”,</p>
<p>“tsMsgReadyForPublish”: “1626778808003021”</p>
</div></blockquote>
<p>}</p>
<p><strong>Response Message:</strong> Error Response for Invalid request JSON</p>
<p>{</p>
<blockquote>
<div><p>“app_seq”: “1234”,</p>
<p>“respPostedByStack”: “0”,</p>
<p>“dataPersist”: true,</p>
<p>“respRcvdByStack”: “0”,</p>
<p>“status”: “Bad”,</p>
<p>“tsMsgRcvdForProcessing”: “1626778808002974”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“tsMsgRcvdFromMQTT”: “1626778808000285”,</p>
<p>“tsMsgPublishOnEII”: “1626778808000437”,</p>
<p>“reqRcvdInStack”: “0”,</p>
<p>“data_topic”: “/flowmeter/PL0/Flow/writeResponse”,</p>
<p>“reqRcvdByApp”: “1626778808001309”,</p>
<p>“metric”: “Flow”,</p>
<p>“usec”: “1626778808001814”,</p>
<p>“reqSentByStack”: “0”,</p>
<p>“error_code”: “100”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“timestamp”: “2021-07-20 11:00:08”,</p>
<p>“tsMsgReadyForPublish”: “1626778808003021”</p>
</div></blockquote>
<p>}</p>
</div>
<div class="section" id="on-demand-read">
<h2>8.3     On-Demand Read<a class="headerlink" href="#on-demand-read" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to read data from some specific Modbus points using MQTT.</p>
<p>To send request: Application should use a topic in the following format to send (i.e., publish) read request on MQTT:</p>
<p><strong>MQTT topic to send (i.e. publish) read request: /device/wellhead/point/read</strong></p>
<p>To receive response: Application should use a topic in the following format to receive (i.e., subscribe) response of read request from MQTT:</p>
<dl class="simple">
<dt><strong>MQTT topic to receive (i.e., subscribe) write response:</strong></dt><dd><p><strong>/device/wellhead/point/readResponse</strong></p>
</dd>
</dl>
<p>Please refer to the table in section 6 for details of fields.</p>
<p><strong>Example:</strong></p>
<p><strong>Request Topic: /flowmeter/PL0/Flow/read</strong></p>
<p><strong>Request Message:</strong></p>
<blockquote>
<div><p>{“wellhead”:”PL0”,”command”:”Flow”,”timestamp”:”2019-09-20 12:34:56”,”usec”:”1571887474111145”,”version”:”2.0”,”app_seq”:”1234”}</p>
</div></blockquote>
<p>A message without “realtime” field is treated as a non-realtime message. To execute a message in realtime way, a field called “realtime” should eb added as shown below:</p>
<blockquote>
<div><p>{“wellhead”:”PL0”,”command”:”Flow”,”timestamp”:”2019-09-20 12:34:56”,”usec”:”1571887474111145”,”version”:”2.0”,”app_seq”:”1234”,”realtime”:”1”}</p>
</div></blockquote>
<p><strong>Response Topic:</strong> /flowmeter/PL0/Flow/readResponse</p>
<p><strong>Response Message:</strong> Success Response</p>
<p>{</p>
<blockquote>
<div><p>“app_seq”: “1234”,</p>
<p>“respPostedByStack”: “1626778599282378”,</p>
<p>“dataPersist”: true,</p>
<p>“respRcvdByStack”: “1626778599282315”,</p>
<p>“status”: “Good”,</p>
<p>“tsMsgRcvdForProcessing”: “1626778599284171”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“scaledValue”: 4,</p>
<p>“value”: “0x0004”,</p>
<p>“tsMsgRcvdFromMQTT”: “1626778599275557”,</p>
<p>“tsMsgPublishOnEII”: “1626778599277242”,</p>
<p>“reqRcvdInStack”: “1626778599279507”,</p>
<p>“data_topic”: “/flowmeter/PL0/Flow/readResponse”,</p>
<p>“reqRcvdByApp”: “1626778599279422”,</p>
<p>“metric”: “Flow”,</p>
<p>“usec”: “1626778599282619”,</p>
<p>“reqSentByStack”: “1626778599280674”,</p>
<p>“timestamp”: “2021-07-20 10:56:39”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“tsMsgReadyForPublish”: “1626778599284240”</p>
</div></blockquote>
<p>}</p>
<p><strong>Response Message:</strong> Error Response</p>
<p>{</p>
<blockquote>
<div><p>“app_seq”: “1234”,</p>
<p>“respPostedByStack”: “0”,</p>
<p>“dataPersist”: false,</p>
<p>“respRcvdByStack”: “0”,</p>
<p>“status”: “Bad”,</p>
<p>“tsMsgRcvdForProcessing”: “1626846987971314”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“tsMsgRcvdFromMQTT”: “1626846987968830”,</p>
<p>“tsMsgPublishOnEII”: “1626846987968983”,</p>
<p>“reqRcvdInStack”: “0”,</p>
<p>“data_topic”: “/flowmeter/PL0/Flow/readResponse”,</p>
<p>“reqRcvdByApp”: “1626846987969861”,</p>
<p>“metric”: “Flow”,</p>
<p>“usec”: “1626846987970320”,</p>
<p>“reqSentByStack”: “0”,</p>
<p>“error_code”: “2003”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“timestamp”: “2021-07-21 05:56:27”,</p>
<p>“tsMsgReadyForPublish”: “1626846987971358”</p>
</div></blockquote>
<p>}</p>
<p><strong>Response Message</strong>: Error Response for Invalid Input JSON</p>
<p>{</p>
<blockquote>
<div><p>“app_seq”: “1234”,</p>
<p>“respPostedByStack”: “0”,</p>
<p>“dataPersist”: false,</p>
<p>“respRcvdByStack”: “0”,</p>
<p>“status”: “Bad”,</p>
<p>“tsMsgRcvdForProcessing”: “1626846987971314”,</p>
<p>“wellhead”: “PL0”,</p>
<p>“tsMsgRcvdFromMQTT”: “1626846987968830”,</p>
<p>“tsMsgPublishOnEII”: “1626846987968983”,</p>
<p>“reqRcvdInStack”: “0”,</p>
<p>“data_topic”: “/flowmeter/PL0/Flow/readResponse”,</p>
<p>“reqRcvdByApp”: “1626846987969861”,</p>
<p>“metric”: “Flow”,</p>
<p>“usec”: “1626846987970320”,</p>
<p>“reqSentByStack”: “0”,</p>
<p>“error_code”: “100”,</p>
<p>“version”: “2.0”,</p>
<p>“realtime”: “0”,</p>
<p>“timestamp”: “2021-07-21 05:56:27”,</p>
<p>“tsMsgReadyForPublish”: “1626846987971358”</p>
</div></blockquote>
<p>}</p>
</div>
<div class="section" id="kpi-application">
<h2>8.4     KPI Application<a class="headerlink" href="#kpi-application" title="Permalink to this headline">¶</a></h2>
<p>Following data (if available) is logged in a log-file by KPI Application for control loops.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/table11_1_update.png"><img alt="../_images/table11_1_update.png" src="../_images/table11_1_update.png" style="width: 528.0px; height: 652.8000000000001px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/table11_2_update.png"><img alt="../_images/table11_2_update.png" src="../_images/table11_2_update.png" style="width: 526.4px; height: 631.2px;" /></a>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="page_09.html" class="btn btn-neutral float-right" title="9.0 Sparkplug-Bridge Operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="page_07.html" class="btn btn-neutral float-left" title="7.0 Site Configurations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, APP

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>